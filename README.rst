ledgeR
------

``ledgeR`` is an R package to import data from plaintext accounting software like Ledger, HLedger, and Beancount into an R data frame for convenient analysis and plotting.

Right now it only supports reading in the register from ``hledger`` files and ``beancount`` files.  ``ledger`` files may or may not work depending on whether ``hledger`` can parse them.

Install
=======

Dependencies
    1. `R <https://cran.r-project.org/>`_
    #. `hledger <http://hledger.org/>`_
    #. `beancount <http://furius.ca/beancount/>`_ (only if you need to read beancount files or run examples)

To install the development version of the ``ledgeR`` package use the ``install_github`` function from the ``devtools`` package in R::
    
    if(!require("devtools")) { install.packages("devtools") }
    devtools::install_github("ledgeR", "trevorld")

Arguments
=========

file
    Filename for an hledger or beancount file.  
include_cleared
    Include cleared transactions (default ``TRUE``).
include_pending
    Include pending transactions (default ``TRUE``).
include_unmarked
    Include unmarked transactions (default ``TRUE``).  
    Effectively ignored for beancount files 
    (which don't support unmarked transactions).
convert_to_cost
    Convert amounts to their cost (default ``FALSE``).
convert_to_market_value
    Convert amounts to their market value (default ``FALSE``).

Examples
========

Example reading in the example beancount file generated by ``bean-example``::

    > library("ledgeR")
    > example_beancount_file <- tempfile(fileext = ".beancount")
    > system(paste("bean-example -o", example_beancount_file), ignore.stderr=TRUE)
    > df <- register(example_beancount_file)
    > head(df)
            date   payee                           description
    1 2015-01-01          Opening Balance for checking account
    2 2015-01-01          Opening Balance for checking account
    3 2015-01-01 BayBook                               Payroll
    4 2015-01-01 BayBook                               Payroll
    5 2015-01-01 BayBook                               Payroll
    6 2015-01-01 BayBook                               Payroll
                              account   amount commodity 
    1         Assets:US:BofA:Checking  3579.30       USD
    2         Equity:Opening-Balances -3579.30       USD
    3         Assets:US:BofA:Checking  1350.60       USD
    4         Assets:US:Vanguard:Cash  1200.00       USD
    5        Income:US:BayBook:Salary -4615.38       USD
    6 Income:US:BayBook:GroupTermLife   -24.32       USD

Here is a example using my personal beancount file (which I won't share) and using the tag argument to filter on a Beancount tag ``#contributions-hsa-cy`` and then in R filtering on an account ``Assets:Retirement:HSA`` and then aggregating amounts by year in order to compute how many "current tax year" Health Savings Account contributions I've made each year::

    > library("ledgeR")
    > library("dplyr")
    > library("lubridate")
    > bfile <- "personal.beancount"
    > df <- register(bfile, tags="#contributions-hsa-cy")
    > df <- filter(df, grepl("Assets:Retirement:HSA", account))
    > group_by(df, year=year(date)) %>% summarise(cy_hsa_contributions = sum(amount))
    # A tibble: 2 Ã— 2
       year cy_hsa_contributions
      <dbl>                <dbl>
    1  2015              3350.01
    2  2016              3349.99
    3  2017              1603.66
